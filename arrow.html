<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Direction Challenge</title>
<style>
/* ================= GENERAL ================= */
body {
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg,#dff6ff,#b5d9ff);
  font-family: Arial, sans-serif;
  text-align: center;
}

.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 30px;
}

/* ================= TITLE ================= */
#arrow-title {
  font-size: 2.2rem; /* smaller for mobile */
  color: #0044aa;
  font-weight: 700;
  margin-bottom: 20px;
}

/* ================= ARROW ================= */
#arrow-container {
  width: 250px;
  height: 250px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg,#e3f2fd 60%,#bbdefb 100%);
  border-radius: 50%;
  box-shadow: 0 2px 12px rgba(0,0,0,0.07);
  border: 1px solid #e0ecff;
  margin-bottom: 24px;
  overflow: hidden;
}

#arrow {
  width: 180px;
  height: 180px;
  transform-origin: 50% 50%;
}

#arrow-shape {
  fill: #1976d2;
  stroke: #0d47a1;
  stroke-width: 2;
}

/* ================= INFO ROW ================= */
.info-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  flex-wrap: wrap;
  margin-bottom: 30px;
}

/* Heatmap box */
#crowd-square {
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg,#e3f2fd 60%,#bbdefb 100%);
  border-radius: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.07);
  border: 1px solid #e0ecff;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
}

#crowd-blobs {
  width: 72px;
  height: 72px;
  display: grid;
  grid-template-columns: repeat(9,1fr);
  grid-template-rows: repeat(9,1fr);
  gap: 1px;
}

.crowd-blob {
  width: 7px;
  height: 7px;
  border-radius: 50%;
}

/* Route speed text */
#route-saying {
  max-width: 220px;
  font-size: 1rem;
  color: #1976d2;
  font-weight: 500;
  background: linear-gradient(135deg,#e3f2fd 60%,#bbdefb 100%);
  border-radius: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.07);
  border: 1px solid #e0ecff;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* ================= MOBILE ================= */
@media (max-width: 600px) {
  #arrow-title { font-size: 1.8rem; margin-bottom: 16px; }
  #arrow-container { width: 200px; height: 200px; margin-bottom: 20px; }
  #arrow { width: 150px; height: 150px; }
  .info-row { flex-direction: row; gap: 12px; }
  #crowd-square { width: 60px; height: 60px; }
  #crowd-blobs { width: 54px; height: 54px; }
  #route-saying { max-width: 160px; font-size: 0.95rem; padding: 10px 12px; }
}
</style>
</head>
<body>
<div class="container">
  <h1 id="arrow-title">Walk into the direction of the arrow</h1>
  
  <div id="arrow-container">
    <svg id="arrow" viewBox="0 0 120 120">
      <polygon id="arrow-shape" points="60,15 100,100 60,75 20,100"/>
    </svg>
  </div>

  <div class="info-row">
    <div id="crowd-square">
      <div id="crowd-blobs"></div>
    </div>
    <div id="route-saying"></div>
  </div>
</div>

<script>
// --- route sayings
const sayings=[
 "We picked this route because it avoids the busiest areas.",
 "This way keeps you out of the densest parts of the crowd.",
 "Get there faster with a route thatâ€™s 30% less crowded.",
 "Move more easily, this route is short and is 15% less crowded.",
 "Save time with a path that cuts through 40% less congestion."
];
document.getElementById("route-saying").textContent=sayings[Math.floor(Math.random()*sayings.length)];

// --- build heatmap
(function(){
 const c=document.getElementById("crowd-blobs");c.innerHTML="";
 for(let r=0;r<9;r++)for(let col=0;col<9;col++){
   const b=document.createElement("div");b.className="crowd-blob";
   if(r<3)b.style.background="#ff5252";
   else{
     const rnd=Math.random();
     b.style.background=rnd<.4?"#ff5252":rnd<.8?"#ffb74d":"#66bb6a";
   }
   c.appendChild(b);
 }
})();

// ---- compass & arrow logic
const arrow=document.getElementById("arrow");
let currentHeading=null,displayHeading=null;
let smoothAlpha=null;

function startCompass(){
 window.addEventListener("deviceorientation",handleOrientation,true);
 requestAnimationFrame(updateArrowSmooth);
}

function handleOrientation(e){
 let heading;
 if(e.webkitCompassHeading!==undefined){heading=e.webkitCompassHeading;}
 else if(e.alpha!=null){heading=360-e.alpha;}
 else return;
 if(smoothAlpha==null)smoothAlpha=heading;
 smoothAlpha=(smoothAlpha*0.85 + heading*0.15); // smooth
 currentHeading=smoothAlpha;
}

function updateArrowSmooth(){
 if(currentHeading!=null){
   if(displayHeading==null)displayHeading=currentHeading;
   displayHeading=(displayHeading*0.75 + currentHeading*0.25);
   arrow.style.transform=`rotate(${-displayHeading}deg)`;
 }
 requestAnimationFrame(updateArrowSmooth);
}

// Auto-start compass on devices that allow it
if(typeof DeviceOrientationEvent!=="undefined" &&
   typeof DeviceOrientationEvent.requestPermission==="function"){
   DeviceOrientationEvent.requestPermission().then(state=>{
     if(state==="granted") startCompass();
   }).catch(()=>{});
}else{startCompass();}
</script>
</body>
</html>
